(this["webpackJsonpspotify-live-lyrics"]=this["webpackJsonpspotify-live-lyrics"]||[]).push([[0],{25:function(t,e,n){},45:function(t,e,n){},47:function(t,e,n){},48:function(t,e,n){},49:function(t,e,n){"use strict";n.r(e);var r=n(3),a=n.n(r),i=n(19),s=n.n(i),c=(n(25),n(4)),o=n.n(c),u=n(8),l=n(1),h=n(2),p=n(6),f=n(5),j=function(){function t(){Object(l.a)(this,t)}return Object(h.a)(t,null,[{key:"setToken",value:function(t){localStorage.setItem("token",t)}},{key:"getToken",value:function(){var t=localStorage.getItem("token");return t||null}},{key:"removeToken",value:function(){return localStorage.removeItem("token")}},{key:"reload",value:function(){window.location.href.split("#").length<=2&&(window.location.href=window.location.href.split("#")[0]),setTimeout((function(){return window.location.reload()}),10)}}]),t}(),b=n(9),v=n.n(b),y=function(){function t(){Object(l.a)(this,t)}return Object(h.a)(t,null,[{key:"getLyrics",value:function(){var t=Object(u.a)(o.a.mark((function t(e,n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.lyricsRequest(e,n,0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"lyricsRequest",value:function(){var t=Object(u.a)(o.a.mark((function t(e,n,r){var a,i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("getting lyrics!"),!(r>4)){t.next=3;break}return t.abrupt("return",null);case 3:return a={Authorization:"Bearer b6fbac76-2ac3-4187-a662-7d9a3f67b346"},"http://localhost:3001/lyrics",t.prev=5,t.next=8,v.a.post("http://localhost:3001/lyrics",{title:e,artist:n},{headers:a});case 8:return i=t.sent,t.abrupt("return",200===i.status?i.data:this.lyricsRequest(e,n,r+1));case 12:return t.prev=12,t.t0=t.catch(5),t.abrupt("return",this.lyricsRequest(e,n,r+1));case 15:case"end":return t.stop()}}),t,this,[[5,12]])})));return function(e,n,r){return t.apply(this,arguments)}}()}]),t}(),O=function(){function t(){Object(l.a)(this,t)}return Object(h.a)(t,null,[{key:"onLoad",value:function(){var t=Object(u.a)(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.getTokenFromUrl(),console.log(e),e&&(j.setToken(e.toString()),j.reload());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getTokenFromUrl",value:function(){var t=window.location.href.split("access_token=");if(t.length<2)return!1;var e=t[1].split("&");return!(e.length<1)&&e[0]}},{key:"login",value:function(){var t="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("59e0135630284383bad818ec9ed70718","&redirect_uri=").concat("https://lyrics.laurensk.at/","&scope=").concat(["user-read-currently-playing"].join("%20"),"&response_type=token");window.open(t,"_self")}},{key:"getCurrentSong",value:function(){var t=Object(u.a)(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v.a.get("https://api.spotify.com/v1/me/player/currently-playing",{headers:{Authorization:"Bearer "+j.getToken()}});case 3:return e=t.sent,t.abrupt("return",e.data);case 7:t.prev=7,t.t0=t.catch(0),t.t0.response.status&&401===t.t0.response.status&&(j.removeToken(),j.reload());case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}()}]),t}(),d=(n(45),n(0)),g=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(d.jsx)("div",{className:"sll-container",children:Object(d.jsx)("div",{className:"sll-container-children",children:this.props.children})})}}]),n}(a.a.Component),k=(n(47),function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var t=this;return Object(d.jsx)("button",{style:this.props.style,className:"sll-button",onClick:function(e){return t.props.onClick()},children:this.props.title})}}]),n}(a.a.Component)),m=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(d.jsx)("h1",{children:this.props.title})}}]),n}(a.a.Component),x=(n(48),function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(d.jsx)("div",{className:"sll-large-text",style:{fontWeight:this.props.fontWeight?this.props.fontWeight:"normal"},children:this.props.text})}}]),n}(a.a.Component)),w=n(20),S=function(){function t(){Object(l.a)(this,t)}return Object(h.a)(t,null,[{key:"getArtists",value:function(t){var e,n="",r=Object(w.a)(t);try{for(r.s();!(e=r.n()).done;){n+=e.value.name+", "}}catch(a){r.e(a)}finally{r.f()}return n.substr(0,n.length-2)}}]),t}(),C=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t)).updateInterval=void 0,r.state={song:null,lyrics:null},r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.getCurrentSong(),this.updateInterval=setInterval((function(){return t.getCurrentSong()}),5e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.updateInterval)}},{key:"getCurrentSong",value:function(){var t=Object(u.a)(o.a.mark((function t(){var e,n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.state.song,t.next=3,O.getCurrentSong();case 3:if(!(n=t.sent)){t.next=14;break}if(this.setState({song:n}),null!=e&&e.item.name===n.item.name){t.next=12;break}return this.setState({lyrics:null}),t.next=10,y.getLyrics(this.state.song.item.name,S.getArtists(this.state.song.item.artists));case 10:(r=t.sent)&&this.setState({lyrics:"\n"+r.trim()});case 12:t.next=15;break;case 14:this.setState({song:null});case 15:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"openLyrics",value:function(t){window.open(t,"_blank")}},{key:"render",value:function(){var t=this;return Object(d.jsxs)(g,{children:[Object(d.jsx)(m,{title:this.state.song?this.state.song.item.name:"It's silent..."}),this.state.song&&Object(d.jsxs)("div",{style:{marginTop:-15},children:[Object(d.jsx)(x,{text:S.getArtists(this.state.song.item.artists)}),Object(d.jsx)("br",{}),Object(d.jsx)(x,{text:this.state.lyrics}),Object(d.jsx)(k,{style:{marginTop:40,marginBottom:70},title:"Open Lyrics on Genius",onClick:function(){return t.openLyrics(t.state.lyrics)}})]})]})}}]),n}(a.a.Component),L=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"login",value:function(){O.login()}},{key:"render",value:function(){var t=this;return Object(d.jsxs)(g,{children:[Object(d.jsx)(m,{title:"Spotify Live Lyrics"}),Object(d.jsx)(x,{text:"Welcome to Spotify Live Lyrics."}),Object(d.jsx)("br",{}),Object(d.jsx)(x,{text:"To get stared, you need to log in with your Spotify account in order to let the application know, which song you're currently listening to. No, worries, we never log or save this data."}),Object(d.jsx)("br",{}),Object(d.jsx)(x,{text:"In fact, this project is open-sourced and the code can be seen on GitHub."}),Object(d.jsx)("br",{}),Object(d.jsx)(x,{fontWeight:"600",text:"To get started with Spotify Live Lyrics, please log in!"}),Object(d.jsx)("br",{}),Object(d.jsx)(k,{title:"Log in with Spotify",onClick:function(){return t.login()}})]})}}]),n}(a.a.Component),T=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t)).state={auth:!1},r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getAuth()}},{key:"getAuth",value:function(){var t=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.getToken();case 2:if(!t.sent){t.next=6;break}this.setState({auth:!0}),t.next=7;break;case 6:O.onLoad();case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.auth?Object(d.jsx)(C,{}):Object(d.jsx)(L,{})}}]),n}(a.a.Component);s.a.render(Object(d.jsx)(a.a.StrictMode,{children:Object(d.jsx)(T,{})}),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.15c23bd6.chunk.js.map