(this["webpackJsonpspotify-live-lyrics"]=this["webpackJsonpspotify-live-lyrics"]||[]).push([[0],{29:function(t,e,n){},52:function(t,e,n){},54:function(t,e,n){},55:function(t,e,n){},56:function(t,e,n){},57:function(t,e,n){"use strict";n.r(e);var r=n(1),a=n.n(r),s=n(20),i=n.n(s),c=(n(29),n(5)),o=n.n(c),u=n(9),l=n(3),h=n(4),p=n(7),f=n(6),b=function(){function t(){Object(l.a)(this,t)}return Object(h.a)(t,null,[{key:"setToken",value:function(t){localStorage.setItem("token",t)}},{key:"getToken",value:function(){var t=localStorage.getItem("token");return t||null}},{key:"removeToken",value:function(){return localStorage.removeItem("token")}},{key:"reload",value:function(){window.location.href.split("#").length<=2&&(window.location.href=window.location.href.split("#")[0]),setTimeout((function(){return window.location.reload()}),10)}}]),t}(),j=n(21),y=n(11),d=n.n(y),v=function(){function t(){Object(l.a)(this,t)}return Object(h.a)(t,null,[{key:"getLyrics",value:function(){var t=Object(u.a)(o.a.mark((function t(e,n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.lyricsRequest(e,n,0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"lyricsRequest",value:function(){var t=Object(u.a)(o.a.mark((function t(e,n,r){var a,s;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("getting lyrics!"),!(r>4)){t.next=3;break}return t.abrupt("return",null);case 3:return a={Authorization:"Bearer b6fbac76-2ac3-4187-a662-7d9a3f67b346"},"https://lyrics.prod.laurensk.at/lyrics",t.prev=5,t.next=8,d.a.post("https://lyrics.prod.laurensk.at/lyrics",{title:e,artist:n},{headers:a});case 8:return s=t.sent,t.abrupt("return",200===s.status?s.data:this.lyricsRequest(e,n,r+1));case 12:return t.prev=12,t.t0=t.catch(5),t.abrupt("return",this.lyricsRequest(e,n,r+1));case 15:case"end":return t.stop()}}),t,this,[[5,12]])})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"openLyrics",value:function(t,e){var n="".concat(t," ").concat(e).toLowerCase().replace(/ *\([^)]*\) */g,"").replace(/ *\[[^\]]*]/,"").replace(/feat.|ft./g,"").replace(/\s+/g," ").trim();return"https://genius.com/search?q="+encodeURI(n)}}]),t}(),g=function(){function t(){Object(l.a)(this,t)}return Object(h.a)(t,null,[{key:"onLoad",value:function(){var t=Object(u.a)(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.getTokenFromUrl(),console.log(e),e&&(b.setToken(e.toString()),b.reload());case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getTokenFromUrl",value:function(){var t=window.location.href.split("access_token=");if(t.length<2)return!1;var e=t[1].split("&");return!(e.length<1)&&e[0]}},{key:"login",value:function(){var t="".concat("https://accounts.spotify.com/authorize","?client_id=").concat("59e0135630284383bad818ec9ed70718","&redirect_uri=").concat("https://lyrics.laurensk.at/","&scope=").concat(["user-read-currently-playing"].join("%20"),"&response_type=token");window.open(t,"_self")}},{key:"getCurrentSong",value:function(){var t=Object(u.a)(o.a.mark((function t(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,d.a.get("https://api.spotify.com/v1/me/player/currently-playing",{headers:{Authorization:"Bearer "+b.getToken()}});case 3:return e=t.sent,t.abrupt("return",e.data);case 7:t.prev=7,t.t0=t.catch(0),t.t0.response.status&&401===t.t0.response.status&&(b.removeToken(),b.reload());case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}()}]),t}(),m=n.p+"static/media/cover.95a561cb.png",O=(n(52),n(0)),k=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(O.jsx)("div",{className:"sll-container",children:Object(O.jsx)("div",{className:"sll-container-children",children:this.props.children})})}}]),n}(a.a.Component),x=n(24),w=function(){function t(){Object(l.a)(this,t)}return Object(h.a)(t,null,[{key:"getArtists",value:function(t){var e,n="",r=Object(x.a)(t);try{for(r.s();!(e=r.n()).done;){n+=e.value.name+", "}}catch(a){r.e(a)}finally{r.f()}return n.substr(0,n.length-2)}}]),t}(),S=(n(54),function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t)).updateInterval=void 0,r.state={song:null,lyrics:null,image:null},r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.getCurrentSong(),this.updateInterval=setInterval((function(){return t.getCurrentSong()}),5e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.updateInterval)}},{key:"getCurrentSong",value:function(){var t=Object(u.a)(o.a.mark((function t(){var e,n,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.state.song,t.next=3,g.getCurrentSong();case 3:if(!(n=t.sent)){t.next=15;break}this.setState({song:n});try{this.setState({image:n.item.album.images[0].url})}catch(a){this.setState({image:null})}if(null!=e&&e.item.name===n.item.name){t.next=13;break}return this.setState({lyrics:"\nLoading lyrics..."}),t.next=11,v.getLyrics(this.state.song.item.name,w.getArtists(this.state.song.item.artists));case 11:(r=t.sent)?this.setState({lyrics:"\n"+r.trim()}):this.setState({lyrics:"\nError loading lyrics..."});case 13:t.next=16;break;case 15:this.setState({song:null});case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"openLyrics",value:function(){window.open(v.openLyrics(this.state.song.item.name,w.getArtists(this.state.song.item.artists)),"_blank")}},{key:"render",value:function(){var t;return Object(O.jsxs)("div",{className:"sll-player-background",children:[Object(O.jsx)(j.a,{children:Object(O.jsx)("style",{children:"body {".concat(this.state.image?"background-color: initial; background-image: url(".concat(this.state.image,"), linear-gradient(rgba(24,24,24,0.5),rgba(24,24,24,0.5));"):"","}")})}),Object(O.jsxs)(k,{children:[!this.state.song&&Object(O.jsx)("div",{children:Object(O.jsx)("p",{children:"its silent"})}),this.state.song&&Object(O.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(O.jsxs)("div",{className:"sll-player-meta",children:[Object(O.jsx)("img",{className:"sll-player-cover",src:null!==(t=this.state.image)&&void 0!==t?t:m,alt:w.getArtists(this.state.song.item.artists)+" - "+this.state.song.item.name}),Object(O.jsxs)("div",{className:"sll-player-song",children:[Object(O.jsx)("p",{className:"sll-player-title",children:this.state.song.item.name}),Object(O.jsx)("p",{className:"sll-player-artist",children:w.getArtists(this.state.song.item.artists)})]})]}),Object(O.jsx)("div",{className:"sll-player-lyrics",children:this.state.lyrics})]})]})]})}}]),n}(a.a.Component)),C=(n(55),function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var t=this;return Object(O.jsx)("button",{style:this.props.style,className:"sll-button",onClick:function(e){return t.props.onClick()},children:this.props.title})}}]),n}(a.a.Component)),L=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(O.jsx)("h1",{children:this.props.title})}}]),n}(a.a.Component),N=(n(56),function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(O.jsx)("div",{className:"sll-large-text",style:{fontWeight:this.props.fontWeight?this.props.fontWeight:"normal"},children:this.props.text})}}]),n}(a.a.Component)),T=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"login",value:function(){g.login()}},{key:"render",value:function(){var t=this;return Object(O.jsxs)(k,{children:[Object(O.jsx)(L,{title:"Spotify Live Lyrics"}),Object(O.jsx)(N,{text:"Welcome to Spotify Live Lyrics."}),Object(O.jsx)("br",{}),Object(O.jsx)(N,{text:"To get stared, you need to log in with your Spotify account in order to let the application know, which song you're currently listening to. No, worries, we never log or save this data."}),Object(O.jsx)("br",{}),Object(O.jsx)(N,{text:"In fact, this project is open-sourced and the code can be seen on GitHub."}),Object(O.jsx)("br",{}),Object(O.jsx)(N,{fontWeight:"600",text:"To get started with Spotify Live Lyrics, please log in!"}),Object(O.jsx)("br",{}),Object(O.jsx)(C,{title:"Log in with Spotify",onClick:function(){return t.login()}})]})}}]),n}(a.a.Component),I=function(t){Object(p.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t)).state={auth:!1},r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.getAuth()}},{key:"getAuth",value:function(){var t=Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.getToken();case 2:if(!t.sent){t.next=6;break}this.setState({auth:!0}),t.next=7;break;case 6:g.onLoad();case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.auth?Object(O.jsx)(S,{}):Object(O.jsx)(T,{})}}]),n}(a.a.Component);i.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(I,{})}),document.getElementById("root"))}},[[57,1,2]]]);
//# sourceMappingURL=main.3dbb7c82.chunk.js.map